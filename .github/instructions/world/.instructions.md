---
description: World design & lore generation constraints
applyTo: '**'
---

# World Module ‚Äì Copilot Instructions

## üìú Purpose

These instructions guide GitHub Copilot on world design, lore generation, and content creation for The Shifting Atlas MMO text adventure. They ensure generated content aligns with established world rules, narrative consistency, and D&D mechanics.

---

## üåç World Design Principles

**Core Vision**: A persistent, AI-driven fantasy world combining D&D mechanics with emergent storytelling. A massive online multiplayer text adventure where players explore, roleplay, and shape the world through their actions.

**Key Pillars:**

-   Emergent storytelling through generative AI
-   Persistent world shaped by player actions
-   Deep roleplay via D&D mechanics and alignment
-   Anti-griefing mechanics that discourage disruptive play
-   Rich lore and evolving political landscapes

**Reference Documentation:**

-   World rules & lore: `docs/modules/world-rules-and-lore.md`
-   Navigation systems: `docs/modules/navigation-and-traversal.md`
-   AI prompt patterns: `docs/modules/ai-prompt-engineering.md`
-   Faction dynamics: `docs/modules/factions-and-governance.md`
-   Economy & trade: `docs/modules/economy-and-trade.md`
-   Extension framework: `docs/modules/extension-framework.md`
-   Quests and dialogue: `docs/modules/quests-and-dialogue-trees.md`
-   Multiplayer mechanics: `docs/modules/multiplayer-mechanics.md`

---

## üó∫ Location & Terrain Design

**Vertex Structure** (Cosmos DB Gremlin):

-   Location vertices with semantic properties
-   Directional exits: north, south, east, west, up, down, in, out
-   Environmental modifiers (terrain type, weather, faction control)
-   Dynamic elements (NPCs, events, resource nodes)

**Design Guidelines:**

-   Each location should have 2-4 meaningful exits
-   Include sensory details (ambient sounds, smells, textures)
-   Reference terrain types that affect movement/skills
-   Consider faction territorial boundaries
-   Support environmental interactivity (burning vines, freezing rivers)

**Semantic Exits:** Use natural language descriptions

-   ‚úÖ "a narrow path through the mist leads north"
-   ‚úÖ "ancient stone steps descend into darkness"
-   ‚ùå Generic "north exit" without context

---

## üé≠ NPC & Dialogue Generation

**Character Consistency:**

-   Maintain personality traits across interactions
-   Reference faction affiliations and political tensions
-   Include D&D alignment indicators in behavior
-   Generate contextual dialogue based on player actions/reputation

**Dialogue Patterns:**

-   Support both scripted quest content and dynamic responses
-   Include skill check opportunities (Charisma, Insight, Deception)
-   Reference current world events and faction standings
-   Maintain lore consistency across all NPCs

**Anti-Griefing Integration:**

-   NPCs respond less favorably to players with poor reputation
-   Disruptive behavior leads to fewer quest opportunities
-   Social mechanics reinforce positive roleplay

---

## ‚öîÔ∏è Combat & D&D Mechanics

**Core Systems:**

-   Standard D&D 5e stat blocks and mechanics
-   Initiative-based turn order for group encounters
-   Skill checks integrated into non-combat scenarios
-   Alignment affects NPC reactions and available choices

**Implementation Guidelines:**

-   All creatures need proper stat blocks with challenge ratings
-   Include environmental factors in combat (terrain, weather)
-   Support both solo and group encounter scaling
-   Integrate with faction warfare when appropriate

---

## üèõ Faction & Political Systems

**Governance Structure:**

-   Multiple competing factions with distinct goals
-   Territory control affects local laws and NPC behavior
-   Dynamic political events shaped by player actions
-   Secret organizations with hidden agendas

**Content Generation:**

-   Reference current faction standings before creating content
-   Include political tension in location descriptions
-   Generate faction-specific quests and opportunities
-   Maintain consistency in territorial boundaries

---

## üìö Lore & Narrative Consistency

**Established Lore Sources:**

-   Core world history and major events
-   Pantheon of deities and religious structures
-   Major historical figures and bloodlines
-   Established trade routes and economic systems

**Content Guidelines:**

-   Always reference existing lore before creating new elements
-   Maintain timeline consistency for historical references
-   Use established naming conventions for places/people
-   Integrate new content with existing storylines

**Prompt Templates:**

-   Store reusable prompts in `shared/src/prompts/`
-   Reference specific lore documents rather than recreating content
-   Include contextual memory for narrative continuity

---

## üîß Extension Framework Integration

**Developer Content:**

-   Support custom quests and dungeon injection
-   Enable unique item crafting and enchantment systems
-   Allow faction expansion and territory modification
-   Provide APIs for custom NPC behavior patterns

**Guidelines:**

-   Extension content must pass lore consistency checks
-   Maintain balance with existing progression systems
-   Support both scripted and AI-generated extension content
-   Document extension points clearly for external developers

---

## üß† AI Prompt Engineering Patterns

Prompt templates are now code-backed in `shared/src/prompts/worldTemplates.ts` for reuse and versioning. Reference them instead of copying raw blocks. See that file for `LOCATION_TEMPLATE`, `NPC_DIALOGUE_TEMPLATE`, and `QUEST_TEMPLATE` constants.

---

## üîÑ Dynamic World Updates

**Event Propagation:**

-   Player actions should affect local and regional politics
-   Economic changes ripple through trade networks
-   Faction conflicts create new opportunities and restrictions
-   Seasonal changes affect available content and NPC behavior

**Content Refresh:**

-   Regularly update location descriptions based on world events
-   Modify NPC dialogue to reflect current political climate
-   Generate new encounters based on faction territorial changes
-   Ensure quest content remains relevant to evolving storylines

---

## üõ° Quality Assurance

**Content Validation:**

-   Verify all new locations have proper exit connections
-   Ensure NPC behavior aligns with established personalities
-   Check lore references for accuracy and consistency
-   Validate D&D mechanics implementation

**Anti-Patterns:**

-   Creating isolated content without world connections
-   Ignoring established faction boundaries or tensions
-   Generating generic fantasy tropes without world-specific context
-   Breaking established lore for convenience

---

## üìñ Reference Quick Links

-   World design overview: `docs/modules.md`
-   Lore documentation: `docs/modules/world-rules-and-lore.md`
-   AI prompt templates: `shared/src/prompts/templates.ts`
-   Navigation mechanics: `docs/modules/navigation-and-traversal.md`
-   Faction systems: `docs/modules/factions-and-governance.md`
-   Extension framework: `docs/modules/extension-framework.md`

_Last reviewed: 2025-10-29_
